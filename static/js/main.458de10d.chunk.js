(this["webpackJsonptile-mapper"]=this["webpackJsonptile-mapper"]||[]).push([[0],{224:function(e,t,n){},225:function(e,t,n){},226:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),l=n.n(i),c=n(2),u=n(3),o=[[]],s={width:64,height:64,tilesWide:4,tilesHigh:4,scale:2},d={},m={textureLoaded:!1,mapLoaded:!1},h=Object(u.b)({application:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_TEXTURE":return Object.assign({},e,{textureLoaded:!0});case"LOAD_MAP":return Object.assign({},e,{mapLoaded:!0});default:return e}},map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_MAP":return t.map;default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TILES_WIDE":return Object.assign({},e,{tilesWide:t.value});case"SET_TILES_HIGH":return Object.assign({},e,{tilesHigh:t.value});case"SET_SCALE":return Object.assign({},e,{scale:t.value});case"LOAD_TEXTURE":var n=t.image,a=n.width,r=n.height;return Object.assign({},e,{width:a,height:r});default:return e}},textureMap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APPLY_STYLE":var n={};return n[t.key]=t.style,Object.assign({},e,n);case"SET_TILES_WIDE":case"SET_TILES_HIGH":return d;default:return e}},texture:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_TEXTURE":return t.image;default:return e}}}),f=n(4),p=n(5),g=n(7),E=n(6),v=n(11),b=n.n(v),O=function(e){var t=e.handleChange,n=e.tilesWide,a=e.tilesHigh,i=e.scale;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"tilesWide"},"Tiles Wide "),r.a.createElement("br",null),r.a.createElement(b.a,{id:"tilesWide",value:n,min:1,max:32,onChange:function(e){t("tilesWide",e)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"tilesHigh"},"Tiles High "),r.a.createElement("br",null),r.a.createElement(b.a,{id:"tilesHigh",value:a,min:1,max:32,onChange:function(e){t("tilesHigh",e)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"scale"},"Scale "),r.a.createElement("br",null),r.a.createElement(b.a,{id:"scale",value:i,step:.1,precision:1,min:1,max:5,onChange:function(e){t("scale",e)}})))},y=Object(c.b)((function(e,t){return{scale:e.settings.scale,tilesHigh:e.settings.tilesHigh,tilesWide:e.settings.tilesWide}}),(function(e,t){return{handleChange:function(t,n){switch(t){case"scale":return e(function(e){return{type:"SET_SCALE",value:e}}(n));case"tilesHigh":return e(function(e){return{type:"SET_TILES_HIGH",value:e}}(n));case"tilesWide":return e(function(e){return{type:"SET_TILES_WIDE",value:e}}(n));default:return}}}}))(O),j=function(e){return new Promise((function(t,n){if(/^data:image/.test(e)){var a=new Image;a.onload=function(){t(a)},a.src=e}else n("Not a valid image file.")}))},w=n(22),L=function(e){var t=e.dropHandler,n=e.text;return r.a.createElement(w.a,{onDrop:t.bind(undefined)},(function(e){var t=e.getRootProps,a=e.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",Object.assign({style:{border:"1px dashed black"}},t()),r.a.createElement("input",a()),r.a.createElement("p",{style:{margin:0,padding:"10px"}},n)))}))},S=Object(c.b)((function(e,t){return{text:"Load Texture",texture:e.texture}}),(function(e,t){return{dropHandler:function(t){(function(e){var t=new FileReader;return new Promise((function(n,a){t.onload=function(t){j(t.target.result).then((function(a){n({name:e.name,dataUri:t.target.result,width:a.width,height:a.height})})).catch((function(e){a(e)}))},t.readAsDataURL(e)}))})(t[0]).then((function(t){e(function(e){return{type:"LOAD_TEXTURE",image:e}}(t))})).catch((function(e){alert(e)}))}}}))(L),T=n(8),_=function(e){for(var t=e.components,n=[],a=[],i=0;i<t[0].length;i++){for(var l=0;l<t.length;l++)a.push(t[l][i]);n.push(r.a.createElement("tr",{key:i},a)),a=[]}return r.a.createElement("table",null,r.a.createElement("tbody",null,n))},x=function(e,t){return Array(e).fill(t)};function D(e){return"[object Array]"===Object.prototype.toString.call(e)}var H=function(e){Object(g.a)(n,e);var t=Object(E.a)(n);function n(e){var a;return Object(f.a)(this,n),(a=t.call(this,e)).state={images:[[]]},a}return Object(p.a)(n,[{key:"generateImages",value:function(e){var t=this,n=e.texture,a=e.tilesWide,r=e.tilesHigh,i=n.dataUri,l=n.width,c=n.height,u=l/a,o=c/r,s=x(a).map((function(e,t){return Promise.all(x(r).map((function(e,n){return function(e,t,n,a,r){var i=document.createElement("canvas");i.width=a,i.height=r;var l=i.getContext("2d");return j(e).then((function(e){return l.drawImage(e,t,n,a,r,0,0,a,r),i.toDataURL()}))}(i,t*u,n*o,u,o).then((function(e){return e}))})))}));Promise.all(s).then((function(e){t.setState({images:e})}))}},{key:"handleDrag",value:function(e,t,n){n.dataTransfer.setData("style",JSON.stringify({image:e,key:t}))}},{key:"componentWillReceiveProps",value:function(e){this.generateImages(e)}},{key:"componentWillMount",value:function(){this.generateImages(this.props)}},{key:"render",value:function(){var e=this,t=this.props,n=t.tilesHigh,a=t.tileWidth,i=t.tileHeight,l=this.state.images.map((function(t,l){return t.map((function(t,c){var u=c*n+l;return r.a.createElement("td",{key:u},r.a.createElement("img",{onDragStart:e.handleDrag.bind(e,t,u),src:t,alt:"".concat(u,"-").concat(l,"-").concat(c),style:{width:a,height:i}}))}))}));return r.a.createElement(_,{components:l})}}]),n}(a.Component),W=n(19),I=Object(W.a)((function(e){return e.settings}),(function(e){var t=e.width,n=e.height,a=e.tilesWide,r=e.tilesHigh,i=e.scale;return{tileWidth:Math.floor(t/a*i),tileHeight:Math.floor(n/r*i)}})),A=Object(c.b)((function(e,t){return Object(T.a)(Object(T.a)({texture:e.texture},I(e)),e.settings)}))(H),N=function(e){var t=e.textureLoaded;return r.a.createElement("div",null,t?r.a.createElement(A,null):r.a.createElement(S,null))},k=Object(c.b)((function(e,t){return{textureLoaded:e.application.textureLoaded}}))(N),M=function(e){var t=new FileReader;return new Promise((function(n,a){t.onload=function(e){try{var t=function(e,t){try{return JSON.parse(e)}catch(n){throw Error(t)}}(e.target.result,"Not a valid JSON file.");if("undefined"===typeof t||!D(t.data)||!D(t.data[0]))throw Error("JSON detected, however the format must be { data: [[]] }.");n(t)}catch(r){a(r.message)}},t.readAsText(e)}))},P=Object(c.b)((function(e,t){return{text:"Load Map",texture:e.texture,overlay:e.textureOverlay}}),(function(e,t){return{dropHandler:function(t){M(t[0]).then((function(t){e(function(e){return{type:"LOAD_MAP",map:e}}(t.data))})).catch((function(e){alert(e)}))}}}))(L),R=function(e){var t=e.value,n=e.textureMap,a=(e.tileHeight,e.tileWidth);if("undefined"===typeof n[t])return r.a.createElement("span",{style:{pointerEvents:"none",fontSize:"".concat(a/2,"px")}},t);var i=n[t].image;return r.a.createElement("img",{src:i,role:"presentation",style:{pointerEvents:"none",width:"100%",height:"100%"}})},C=(n(32),function(e){var t=function(t,n){var a=JSON.parse(n.dataTransfer.getData("style"));e.applyStyle(t,a)},n=e.tileWidth,a=e.tileHeight,i=e.tiles.map((function(i,l){return i.map((function(c,u){return r.a.createElement("td",{key:u+l*i.length,onDrop:t.bind(undefined,c),onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault()},onDragLeave:function(e){e.preventDefault()},style:{width:n,height:a,minWidth:n,minHeight:a}},r.a.createElement(R,Object.assign({},e,{value:c})))}))}));return r.a.createElement("div",{className:"Map"},r.a.createElement(_,{components:i}))}),U=Object(c.b)((function(e,t){return Object(T.a)(Object(T.a)({tiles:e.map,textureMap:e.textureMap},I(e)),e.settings)}),(function(e,t){return{applyStyle:function(t,n){e(function(e,t){return{type:"APPLY_STYLE",key:e,style:t}}(t,n))}}}))(C),J=function(e){var t=e.mapLoaded;return r.a.createElement("div",null,t?r.a.createElement(U,null):r.a.createElement(P,null))},X=Object(c.b)((function(e,t){return{mapLoaded:e.application.mapLoaded}}))(J),F=n(230),Y=n(229),G=function(e){Object(g.a)(n,e);var t=Object(E.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{style:{overflowWrap:"break-word"}},r.a.createElement(F.a,{language:"json",style:Y.a},JSON.stringify(this.props.textureMap,null,2)))}}]),n}(a.Component),V=Object(c.b)((function(e,t){return{textureMap:e.textureMap}}))(G),z=(n(224),function(e){Object(g.a)(n,e);var t=Object(E.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-8"},r.a.createElement("h3",null," Tile Mapper "),r.a.createElement("div",{className:"flex-display"},r.a.createElement(X,null),r.a.createElement(k,null)),r.a.createElement(V,null)),r.a.createElement("div",{className:"col-4"},r.a.createElement("form",null,r.a.createElement("h5",null," Settings "),r.a.createElement("hr",null),r.a.createElement(y,null)))))}}]),n}(a.Component)),B=(n(225),Object(u.c)(h,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));l.a.render(r.a.createElement(c.a,{store:B},r.a.createElement(z,null)),document.getElementById("root"))},32:function(e,t,n){}},[[226,1,2]]]);
//# sourceMappingURL=main.458de10d.chunk.js.map